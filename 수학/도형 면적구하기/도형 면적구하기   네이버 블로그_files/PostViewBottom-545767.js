var PostViewBottomTitleListController=$Class({$jsMVC:jsMVC.$Controller,$init:function(){},start:function(i,f,b,d,c,g,e,h,a){this.mPostViewBottomTitleList=jsMVC.getModel("postViewBottomTitleListController","postViewBottomTitleListModel");this.vPostViewBottomTitleList=jsMVC.getView("postViewBottomTitleListController","postViewBottomTitleListView");this.sBlogId=i;this.nFirstLogNo=f;this.bIsShowPopularPosts=b;this.sViewDate=e;this.nParentCategoryNo=(e!=""||d==0)?"":d;this.nCategoryNo=(c==0||d==c)?"":c;this.sEncodedCategoryName=g;this.nFirstSortDate=h;this.sFrom=a;$Fn(this._load,this).attach(window,"load");$Fn(this._click,this).attach($("postListBottom"),"click")},_load:function(){this.vPostViewBottomTitleList.start(this.sBlogId,this.nFirstLogNo,this.bIsShowPopularPosts,this.nParentCategoryNo,this.nCategoryNo,this.sViewDate,this.sFrom);this._fetchBottomTitleList(false,false,this.nFirstLogNo,this.nFirstSortDate);if(this.bIsShowPopularPosts){this._fetchPopularPostTitle(1)}},_click:function(b){var d=$Element(b.element).parent(function(g){return g.className().indexOf("_previous_")>0|g.className().indexOf("_next_")>0},1);if(d==null||d.length==0){return}var c=$Element(d[0]);var f=utility.getParam(c.className());if(c.hasClass("_previous_category")||c.hasClass("_next_category")){if(f.length==2){var a=f[0];var e=f[1];if(a!=""&&e!=""){this._fetchBottomTitleList(c.hasClass("_previous_category"),!c.hasClass("_previous_category"),a,e)}}}else{if(c.hasClass("_previous_popular")){this._fetchPopularPostTitle(1)}else{if(c.hasClass("_next_popular")){this._fetchPopularPostTitle(2)}}}if(c.hasClass("_returnFalse")){b.stop()}},_fetchBottomTitleList:function(e,b,a,d){if(!a){a=this.nFirstLogNo}if(!d){d=this.vPostViewBottomTitleList.findSortDateInMilli();if(isNaN(d)){d=new Date().getTime()}}var c={sBlogId:this.sBlogId,sLogNo:a,nParentCategoryNo:this.nParentCategoryNo,nCategoryNo:this.nCategoryNo,sViewDate:this.sViewDate,bShowNextPage:!!b,bShowPreviousPage:!!e,nSortDateInMilli:d};this.mPostViewBottomTitleList.fetchTitleList(c)},_fetchPopularPostTitle:function(a){this.mPostViewBottomTitleList.fetchPopularPostTitleList({sBlogId:this.sBlogId,nPage:a})}});var PostViewBottomTitleListModel=$Class({$init:function(){this.gotBottomCategoryPostTitleList=new jsMVC.Event();this.gotPopularPostTitleList=new jsMVC.Event()},_isNotValidRequiredParam:function(a){if(a==null||a.sBlogId==null){return true}return false},fetchTitleList:function(c){if(this._isNotValidRequiredParam(c)){return}var a="/PostViewBottomTitleListAsync.nhn";var b=$Fn(this._afterFetchBottomCategoryPostTitleList,this).bind();this._fetch(a,b,this._makeParameterMap(c))},fetchPopularPostTitleList:function(b){if(this._isNotValidRequiredParam(b)){return}var c="PostViewPopularPostTitleListAsync.nhn";var a=$Fn(this._afterFetchTopPostTitleList,this).bind();this._fetch(c,a,{blogId:b.sBlogId,currentPage:b.nPage})},_fetch:function(b,c,a){new $Ajax(b,{onload:function(d){c(d)},method:"post"}).request(a)},_makeParameterMap:function(b){var a=$H({blogId:b.sBlogId,logNo:b.sLogNo,viewDate:b.sViewDate,categoryNo:b.nCategoryNo,parentCategoryNo:b.nParentCategoryNo,showNextPage:b.bShowNextPage,showPreviousPage:b.bShowPreviousPage,sortDateInMilli:b.nSortDateInMilli}).filter(function(d,c,e){return d!=null});return a.$value()},_afterFetchBottomCategoryPostTitleList:function(a){if(a.status()==200){var b=a.json();if(b.success!=true){return}this.gotBottomCategoryPostTitleList.notify({aPostList:b.postList,bHasNextPage:b.hasNextPage,bHasPreviousPage:b.hasPreviousPage,nNextIndexLogNo:b.nextIndexLogNo,nNextIndexSortDate:b.nextIndexSortDate,nPreviousIndexLogNo:b.previousIndexLogNo,nPreviousIndexSortDate:b.previousIndexSortDate})}},_afterFetchTopPostTitleList:function(a){if(a.status()==200){var b=a.json();this.gotPopularPostTitleList.notify({bIsSuccess:b.success,aPostList:b.postList,bHasNextPage:b.hasNextPage,bHasPreviousPage:b.hasPreviousPage})}}});var PostViewBottomTitleListView=$Class({$init:function(){this._wtplListBody="";this._elPostListBottomDiv=$("postListBottom")},start:function(g,e,d,c,b,f,a){this.nFirstPostLogNo=e;this._initTitleTemplate(g,c,b,f,d,a);this._assignModelEventHandlers();this._locateTopButton()},_initTitleTemplate:function(h,f,e,g,d,c){var b=[];b.push('<tr><td class="lt">');b.push('<span class="bu"><img width="2" height="2" class="fil5 pcol2b" src="http://blogimgs.naver.net/nblog/spc.gif"></span>');b.push('<a logno="{=logNo}" href="/PostView.nhn?blogId=');b.push(h);b.push("&logNo={=logNo}&parentCategoryNo=");b.push(f);b.push("&categoryNo=");b.push(e);b.push("&viewDate=");b.push(g);b.push("&isShowPopularPosts=");b.push(d);b.push("&from=");b.push(c);b.push('" class="pcol2"><span class="itemfont">{=title}</span></a>&nbsp;<span class="num pcol3">{if commentCount > 0}(<strong>{=commentCount}</strong>){/if}</span></td>');b.push('<td class="date fil5 pcol2"><p>{=addDate}</p></td></tr>');this._wtplListBody=$Template(b.join(""));var a=[];a.push('<td class="pg pcol2">{if !bHasPreviousPage}<em class="fil5 pcol2"><span class="arw">◀</span> <span>이전</span></em>{else}<a class="pcol2 _previous{=sNavigationPostfix} _param({=nPreviousIndexLogNo}|{=nPreviousIndexSortDate}) _returnFalse" href="/"><span class="arw">◀</span> <span>이전</span></a>{/if}</td>');a.push('<td><img width="1" height="11" alt="" class="fil3 pcol2b" src="http://blogimgs.naver.net/imgs/nblog/spc.gif"></td>');a.push('<td class="pg pcol2">{if !bHasNextPage}<em class="fil5 pcol2"><span>다음</span> <span class="arw">▶</span></em>{else}<a class="pcol2 _next{=sNavigationPostfix} _param({=nNextIndexLogNo}|{=nNextIndexSortDate}) _returnFalse" href="/"><span>다음</span> <span class="arw">▶</span></a>{/if}</td>');this._wtplNavigation=$Template(a.join(""))},_assignModelEventHandlers:function(){var a=jsMVC.getModel("postViewBottomTitleListController","postViewBottomTitleListModel");a.gotBottomCategoryPostTitleList.attach($Fn(function(b){this._generateTitleList(b.aPostList,b.bHasNextPage,b.bHasPreviousPage,b.nNextIndexLogNo,b.nNextIndexSortDate,b.nPreviousIndexLogNo,b.nPreviousIndexSortDate,"postBottomTitleListBody","postBottomTitleListNavigation","_category");this._hightlightCurrentPost()},this).bind());a.gotPopularPostTitleList.attach($Fn(function(b){if(!!b.bIsSuccess){this._generateTitleList(b.aPostList,b.bHasNextPage,b.bHasPreviousPage,"","","","","popularPostTitleListBoddy","popularPostTitleListNavigation","_popular")}else{this._hidePopularPostListArea();this._locateTopButton(0)}},this).bind())},_generateTitleList:function(m,n,a,c,l,d,g,f,k,b){var j=[];for(var e=0;e<m.length;e++){var h=m[e];j.push(this._wtplListBody.process({logNo:h.logNo,title:utility.truncate(utility.decodeURIComponentForJava(h.title),70,".."),addDate:h.addDate,commentCount:h.commentCount}))}$Element(f).html(j.join(""));$Element(k).html(this._wtplNavigation.process({bHasPreviousPage:a,bHasNextPage:n,nNextIndexLogNo:c,nNextIndexSortDate:l,nPreviousIndexLogNo:d,nPreviousIndexSortDate:g,sNavigationPostfix:b}))},_hightlightCurrentPost:function(){var a=$$.getSingle("a[logNo="+this.nFirstPostLogNo+"]",$("postBottomTitleListBody"));if(a==null){return}a.innerHTML="<b><u>"+a.innerHTML+"</u></b>"},_hidePopularPostListArea:function(){var b=$$("._popularPostListElement",this._elPostListBottomDiv);for(var a=0;a<b.length;a++){$Element(b[a]).hide()}},_topButtonMarkUp:'<a href="#"><span class="pcol2 i1"><em>▲</em> top</span></a>',_locateTopButton:function(a){var b=$$("._toTop");if(a!=null&&b.length>a){b[a].innerHTML=this._topButtonMarkUp}else{if(b!=null&&b.length>0){b[b.length-1].innerHTML=this._topButtonMarkUp}}},findSortDateInMilli:function(){var a=$$.getSingle("._postAddDate");if(!!a){return Date.parse(a.innerHTML)}else{return new Date().getTime()}}});jsMVC.setController("postViewBottomTitleListController",PostViewBottomTitleListController);jsMVC.setModel("postViewBottomTitleListController","postViewBottomTitleListModel",PostViewBottomTitleListModel);jsMVC.setView("postViewBottomTitleListController","postViewBottomTitleListView",PostViewBottomTitleListView);var postViewBottomTitleListController=jsMVC.getController("postViewBottomTitleListController");if(typeof(window.defineNHNJS)=="undefined"){window.defineNHNJS={}}window.defineNHNJS["PostViewBottom-545767_js"]=true;